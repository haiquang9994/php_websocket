(()=>{function t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o=[],s=!0,a=!1;try{for(e=e.call(t);!(s=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);s=!0);}catch(t){a=!0,i=t}finally{try{s||null==e.return||e.return()}finally{if(a)throw i}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var e,r;e={websockets:{},ws_run:function(n,r){var i=this,o=new WebSocket(r),s=null;try{(s=this.ws_find(n)).socket=o}catch(n){s={events:[],stacks:[],socket:o,meta:{count:0,callbacks:{}},ping:void 0}}this.websockets[n]=s,o.onopen=function(t){for(var e=i.ws_find(n).stacks,r=e.shift();r;)o.send(r),r=e.shift();s.ping=setInterval(function(){o.send(s.meta.count++)},15e3)},o.onmessage=function(r){var s=JSON.parse(r.data),a=e.ws_find(n).meta;if(s instanceof Array)if(3===s.length){var c=t(s,3),u=(c[0],c[1]),l=c[2];(i.websockets[n].events[u]||[]).forEach(function(t){"function"==typeof t&&t.call(o,l)})}else{var f=t(s,2),h=f[0],d=f[1],v=a.callbacks,p=v[h];delete v[h],"function"==typeof p&&p.call(null,d)}},o.onclose=function(){clearInterval(s.ping),setTimeout(function(){i.ws_run(n,r)},1500)}},ws_push_event:function(t,n,e){var r=this.ws_find(t).events;r[n]||(r[n]=[]),r[n].push(e)},ws_push_stack:function(t,n){this.ws_find(t).stacks.push(n)},ws_find:function(t){var n=this.websockets[t];if(!n)throw"Socket not found!";return n},ws_url:function(t,n){var e={},r=t.split("#")[0].split("?"),i=r[0].replace("http","ws");(r[1]||"").split("&").map(function(t){return t.split("=")}).filter(function(t){return 2===t.length}).forEach(function(t){e[t[0]]=t[1]}),e.sid=n;var o=[];for(var s in e){var a=e[s];o.push("".concat(s,"=").concat(a))}return i+"?"+o.join("&")},ws_emit:function(t,n,r,i){var o=e.ws_find(t),s=o.socket,a=o.meta,c=JSON.stringify([a.count,n,r]);a.callbacks[a.count++]=i,s&&1===s.readyState?s.send(c):e.ws_push_stack(t,c)}},r=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=Math.random().toString(36).substr(2,9)+Math.random().toString(36).substr(2,9)+Math.random().toString(36).substr(2,9),e.ws_run(this.id,e.ws_url(n,this.id))}var n;return(n=[{key:"on",value:function(t,n){e.ws_push_event(this.id,t,n)}},{key:"emit",value:function(t,n,r){e.ws_emit(this.id,t,n,r)}}])&&function(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,n),t}(),window.WSClient=r})();